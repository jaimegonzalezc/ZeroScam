# ZeroScam
![alt text](images/ZeroScam-logo.png)

ZeroScam es una herramienta completa de ciberseguridad pensada para que usuarios puedan consultar dudas referentes a la seguridad digital, prevenciÃ³n de ciberestafas y consulta de normativas. 

Se trata de un Agente IA que usa DeepSeek R1 como modelo base con un finetuning con un dataset formado por la fusiÃ³n de varios datasets pregunta-respuesta sobre temas de ciberseguridad. 

AdemÃ¡s se ha alimentado el contexto con un RAG con las normativas:
* NIST
* GDPR
* ISO 27001 

Esto permite conocer con detalle aspectos de estas normativas y consultar detalles sobre las mismas evitando que el modelo alucine con esta informaciÃ³n. 

A continuaciÃ³n se detalla la arquitectura establecida:

![alt text](images/ZeroScam-Architecture.png)

La aplicaciÃ³n se ha dockerizado con una imagen base CUDA para ser mÃ¡s eficiente utilizando los recursos de GPU. La idea detrÃ¡s de esto es poder ejecutar el modelo en cualquier servicio de nube con capacidad de GPU, como Kubernetes, Azure o AWS.

## Estructura del proyecto
```bash
ZeroScam/
â”œâ”€â”€ app/                         # AplicaciÃ³n principal
â”‚   â”œâ”€â”€ Dockerfile               # ConfiguraciÃ³n para contenedor Docker
â”‚   â”œâ”€â”€ requirements.txt         # Dependencias del proyecto
â”‚   â””â”€â”€ zeroscam.py              # Script principal
â”œâ”€â”€ data/                        # GeneraciÃ³n de dataset final
â”œâ”€â”€ docs/                        # DocumentaciÃ³n del proyecto
â”‚   â”œâ”€â”€ ZeroScam_Origin.pptx     # PresentaciÃ³n de introducciÃ³n al proyecto
â”‚   â”œâ”€â”€ ZeroScam.docx            # Documento detallado sobre ZeroScam
â”‚   â””â”€â”€ ZeroScamArchitecture.drawio # Diagrama de arquitectura del sistema
â”œâ”€â”€ images/                      # ImÃ¡genes utilizadas en la documentaciÃ³n
â”œâ”€â”€ model/                       # Modelos de IA utilizados en todas las etapas del proyecto. El modelo final estÃ¡ en Hugging Face: CasiAC/deepseek-r1-8b-ciberseguridad
â”‚   â”œâ”€â”€ Deepseek_R1_8B_Ciberseguridad.ipynb # Modelo Deepseek especializado en ciberseguridad
â”‚   â”œâ”€â”€ Finetunning_Deepseek_R1_8B_LoRA.ipynb # Ajuste fino con LoRA para Deepseek
â”‚   â”œâ”€â”€ Finetunning_Mistral.ipynb # Ajuste fino de un modelo Mistral
â”‚   â”œâ”€â”€ Model+OCR.ipynb          # IntegraciÃ³n de modelo de IA con OCR
â”‚   â””â”€â”€ ZeroShot.ipynb           # ImplementaciÃ³n de aprendizaje Zero-Shot
â”œâ”€â”€ ocr/                         # Scripts de reconocimiento Ã³ptico de caracteres
â”‚   â”œâ”€â”€ images/                  # ImÃ¡genes de prueba para OCR
â”‚   â”œâ”€â”€ OCRs.ipynb               # ImplementaciÃ³n bÃ¡sica de OCR
â”‚   â””â”€â”€ UpgradedTesseractOCR.ipynb # VersiÃ³n mejorada con Tesseract OCR
â”œâ”€â”€ pipeline/                    # Procesos y pruebas del modelo
â”‚   â”œâ”€â”€ Analyze_URL.ipynb        # AnÃ¡lisis de URLs sospechosas
â”‚   â””â”€â”€ Prueba_Modelo.ipynb      # Prueba de funcionamiento del modelo
â”œâ”€â”€ rag/                         # ImplementaciÃ³n de Retrieval-Augmented Generation
â”‚   â””â”€â”€ RAG_Ciberseguridad_Normativa.ipynb # Sistema RAG para normativa de ciberseguridad
â”œâ”€â”€ regulaciones/                # Archivos relacionados con normativas y regulaciones
â”œâ”€â”€ telegram/                    # IntegraciÃ³n con Telegram
â”‚   â”œâ”€â”€ model_loader.py          # Carga del modelo en el bot
â”‚   â”œâ”€â”€ telegram_bot.ipynb       # ImplementaciÃ³n del bot en Jupyter Notebook
â”‚   â””â”€â”€ telegram_bot.py          # CÃ³digo principal del bot de Telegram
â”œâ”€â”€ .env                         # Variables de entorno necesarias para la configuraciÃ³n
â”œâ”€â”€ .gitignore                   # Archivos y carpetas ignorados por Git
â”œâ”€â”€ README.md                    # DocumentaciÃ³n principal del repositorio
â””â”€â”€ ZeroScam.ipynb               # VersiÃ³n completa de la aplicaciÃ³n para ejecutar el modelo
```

## EjecuciÃ³n

La forma mÃ¡s sencilla de ejecutar el proyecto es ejecutar el notebook `ZeroScam.ipynb` en Google Colab con un entorno de ejecuciÃ³n A100. El Ãºnico requisito serÃ¡ actualizar los tokens necesarios:

```python
# TOKEN ngrok 
ngrok.set_auth_token("Tu Ngrok token")

# VirusTotal API Key
API_KEY = "Tu VirusTotal API Key"

# Telegram Token
TELEGRAM_TOKEN = "Tu telegram bot token"
```

TambiÃ©n se ha dockerizado la aplicaciÃ³n pudiendo ejecutarla en cualquier entorno de nube optimizado para uso de GPUs. PAra construir la imagen, ir a la carpeta /app y ejecutar:

```docker build -t zeroscam-app .```

Para ejecutar el contenedor: 

```docker run --gpus all -p 8000:8000 -e TELEGRAM_TOKEN="TU_TOKEN" zeroscam-app```

A continuaciÃ³n se detalla el desarrollo realizado. 

 ---
 # ðŸ›  Fine-Tuning DeepSeek R1 (Distill Llama 8B) + LoRA para el Agente de Ciberseguridad ZeroScam  

Implementa el fine-tuning de un modelo de lenguaje de **8B parÃ¡metros** utilizando **LoRA (Low-Rank Adaptation)** para optimizar su entrenamiento en tareas de **ciberseguridad**.  

El objetivo es entrenar un modelo especializado para **detecciÃ³n y prevenciÃ³n de amenazas cibernÃ©ticas**, integrÃ¡ndolo en un sistema **RAG (Retrieval-Augmented Generation)** que consulta normativas de ciberseguridad para mejorar sus respuestas.  

---

## ðŸ”¹ Modelo Base: DeepSeek R1 Distill Llama 8B  

El modelo base utilizado es **`deepseek-ai/DeepSeek-R1-Distill-Llama-8B`**, que es una versiÃ³n distillada de **LLaMA 2** con **8.000 millones de parÃ¡metros**.  

### âœ… CaracterÃ­sticas principales:  

- **OptimizaciÃ³n en eficiencia y rendimiento** â†’ ReducciÃ³n del tamaÃ±o del modelo con mÃ­nima pÃ©rdida de capacidad.  
- **Entrenado en mÃºltiples idiomas** â†’ Soporta inglÃ©s y otros idiomas con alta precisiÃ³n.  
- **Eficiencia computacional** â†’ Se ha **cuantificado a 4 bits** para reducir el uso de memoria sin afectar el rendimiento significativamente.  

### ðŸ“Œ Â¿Por quÃ© DeepSeek R1 Distill Llama 8B?  

Este modelo se eligiÃ³ porque ofrece un **buen equilibrio entre tamaÃ±o y capacidad**, lo que permite ejecutar el fine-tuning en hardware limitado (**GPU con memoria reducida**) sin sacrificar demasiado rendimiento.  

---

## ðŸ“š Datasets Utilizados  

Para entrenar el modelo, se han seleccionado **4 datasets especializados** en ciberseguridad que contienen informaciÃ³n sobre **ataques, defensa, normativas y buenas prÃ¡cticas**.  

| **Dataset** | **DescripciÃ³n** | **Ejemplos** |  
|------------|---------------|-------------|  
| `ahmed000000000/cybersec` | Seguridad informÃ¡tica general | 2.500 |  
| `dzakwan/cybersec` | Amenazas y defensa en ciberseguridad | 2.500 |  
| `asimsultan/cyber2k` | Distintos aspectos de ciberseguridad | 2.000 |  
| `Vanessasml/cybersecurity_32k_instruction_input_output` | InstrucciÃ³n-respuesta para modelos conversacionales | 2.500 |  

ðŸ”¹ **Total de ejemplos**: **9.500 muestras** de texto enfocadas en ciberseguridad.  

Estos datasets han sido **procesados y combinados** para mejorar la capacidad de **comprensiÃ³n y respuesta** del modelo ante preguntas relacionadas con **seguridad informÃ¡tica y normativas**.  

---

## ðŸ›  Fine-Tuning con LoRA  

Para optimizar el entrenamiento, se ha utilizado **LoRA (Low-Rank Adaptation)**, una tÃ©cnica que permite afinar **grandes modelos de lenguaje** de manera eficiente.  

### ðŸ”¹ Â¿CÃ³mo funciona LoRA?  

1. **Congela los pesos del modelo base** â†’ En lugar de ajustar todos los parÃ¡metros del modelo, LoRA solo modifica un pequeÃ±o subconjunto de ellos.  
2. **Agrega capas de adaptaciÃ³n de bajo rango** â†’ Estas capas capturan los ajustes especÃ­ficos sin alterar el modelo original.  
3. **Reduce los requisitos de cÃ³mputo** â†’ Como solo se actualiza una parte del modelo, se necesita menos VRAM y menos tiempo de entrenamiento.  

### ðŸ“Œ Ventajas de LoRA en este Proyecto  

âœ… **Menor consumo de memoria** â†’ Permite entrenar modelos grandes sin necesidad de **GPUs costosas**.  
âœ… **Mayor eficiencia** â†’ Mantiene la capacidad del modelo base, pero lo adapta a un **dominio especÃ­fico**.  
âœ… **Mejora en respuestas especializadas** â†’ El modelo **aprende sobre ciberseguridad** sin perder conocimiento general.  

---

## ðŸ“¤ PublicaciÃ³n en Hugging Face  

Una vez completado el **fine-tuning**, el modelo es subido a **Hugging Face**, donde estarÃ¡ disponible para su uso en **aplicaciones de ciberseguridad**.  

ðŸ”¹ **Repositorio en Hugging Face**: **CasiAC/deepseek-r1-8b-ciberseguridad**.

Este modelo podrÃ¡ integrarse con el **sistema RAG**, mejorando la **calidad y precisiÃ³n** de las respuestas basadas en normativas de ciberseguridad. ðŸš€  

---

## ðŸŽ¯ Resumen del Flujo en Google Colab  

1. **Instalar dependencias** (`bitsandbytes`, `transformers`, `accelerate`, `peft`).  
2. **Montar Google Drive** para acceder a los datos de entrenamiento.  
3. **Cargar el modelo DeepSeek R1 8B** y configurarlo con **cuantizaciÃ³n a 4 bits**.  
4. **Preprocesar datasets** de ciberseguridad para su uso en fine-tuning.  
5. **Entrenar el modelo con LoRA** en **Google Colab** usando la **GPU A100**.  
6. **Subir el modelo a Hugging Face** para su uso en el sistema **RAG**.  

---

## ðŸ”¥ ConclusiÃ³n  

Este proyecto permite entrenar un **modelo especializado en ciberseguridad** utilizando un enfoque **eficiente con LoRA**.  

âœ… **Fine-tuning de DeepSeek R1 8B** con LoRA para optimizaciÃ³n de memoria.  
âœ… **Entrenamiento con 9.500 ejemplos** de datasets especializados.  
âœ… **PublicaciÃ³n en Hugging Face** para su integraciÃ³n en sistemas conversacionales.  
âœ… **ImplementaciÃ³n en RAG** para mejorar la generaciÃ³n de respuestas basadas en normativas oficiales.  

Con esta implementaciÃ³n, el **agente de ciberseguridad ZeroScam** podrÃ¡ responder con **precisiÃ³n** a consultas sobre **seguridad informÃ¡tica, normativas y mejores prÃ¡cticas**. ðŸš€

---

## Procesado de la normativa para posterior RAG

### 1: ConversiÃ³n de PDF a JSON
#### Â¿QuÃ© hicimos?
Transformamos los documentos en formato PDF a JSON, extrayendo el texto y organizÃ¡ndolo por pÃ¡ginas.

#### Â¿Por quÃ© lo hicimos?
- Los PDFs no son fÃ¡cilmente manipulables en NLP o bases de datos.
- Un formato estructurado (JSON) permite trabajar con el texto fÃ¡cilmente, conservando su estructura original.
- Facilita el procesamiento posterior, como la segmentaciÃ³n y extracciÃ³n de informaciÃ³n relevante.

### 2: Limpieza del Texto
#### Â¿QuÃ© hicimos?
Aplicamos un preprocesamiento de texto eliminando caracteres innecesarios, espacios adicionales y normalizando el contenido.

#### Â¿Por quÃ© lo hicimos?
- El texto extraÃ­do puede contener sÃ­mbolos y caracteres especiales que no aportan valor.
- La limpieza mejora la calidad del anÃ¡lisis NLP, eliminando ruido que podrÃ­a afectar la tokenizaciÃ³n y generaciÃ³n de embeddings.

### 3: TokenizaciÃ³n y SegmentaciÃ³n con Ventanas Deslizantes
#### Â¿QuÃ© hicimos?
- Dividimos el texto en oraciones y eliminamos stopwords y puntuaciÃ³n.
- Agrupamos las oraciones en fragmentos superpuestos llamados ventanas deslizantes para preservar el contexto.

### 4: GeneraciÃ³n de Embeddings
#### Â¿QuÃ© hicimos?
Convertimos cada fragmento de texto en vectores numÃ©ricos (embeddings) usando modelos de lenguaje preentrenados.

#### Â¿Por quÃ© lo hicimos?
- Los embeddings permiten comparar significados de textos, en lugar de depender solo de coincidencias exactas de palabras.
- Son esenciales para hacer bÃºsquedas semÃ¡nticas en bases de datos vectoriales.

### 5: Almacenamiento en ChromaDB
#### Â¿QuÃ© hicimos?
Guardamos los embeddings en ChromaDB, una base de datos vectorial optimizada para bÃºsquedas semÃ¡nticas.

#### Â¿Por quÃ© lo hicimos?
- Las bases de datos vectoriales permiten encontrar documentos similares en significado, no solo por palabras clave exactas.
- Optimiza la bÃºsqueda en textos largos como normativas y regulaciones.

---

## RAG Normativa de Ciberseguridad

La tÃ©cnica **Retrieval-Augmented Generation (RAG)**, o **GeneraciÃ³n Aumentada por RecuperaciÃ³n**, 
es una metodologÃ­a innovadora que combina la potencia de los modelos de lenguaje de gran escala (LLM)
con la capacidad de recuperar informaciÃ³n externa y actualizada. Esto permite que el modelo no se limite
Ãºnicamente a su conocimiento preentrenado, sino que pueda acceder a datos recientes y especÃ­ficos, lo 
que resulta fundamental en un campo tan dinÃ¡mico como la ciberseguridad.

### Â¿QuÃ© es RAG?

RAG integra dos componentes esenciales:

1. **RecuperaciÃ³n (Retrieval):**  
   Permite buscar y extraer informaciÃ³n relevante de bases de datos o documentos normativos, brindando 
   al modelo acceso a datos actualizados y especializados.

2. **GeneraciÃ³n (Generation):**  
   Utiliza un modelo de lenguaje para generar respuestas enriquecidas con la informaciÃ³n recuperada. 
   En este caso, se utiliza el modelo **Deepseek R1 8B Ciberseguridad**, que ha sido previamente entrenado
   mediante tÃ©cnicas de **Fine-tuning** y **LoRA**.

Esta combinaciÃ³n mejora notablemente la precisiÃ³n y relevancia de las respuestas, ya que el modelo puede 
complementar su conocimiento interno con datos externos verificados.

---

### AplicaciÃ³n en la Normativa de Ciberseguridad

El notebook implementa una soluciÃ³n RAG para potenciar el rendimiento del modelo **Deepseek R1 8B Ciberseguridad**. 
La integraciÃ³n de la normativa de ciberseguridad permite que el modelo:

- **Acceda a informaciÃ³n actualizada:**  
  Consulta en tiempo real documentos normativos y estÃ¡ndares reconocidos.

- **Genere respuestas contextualizadas:**  
  Combina su conocimiento preentrenado con informaciÃ³n especÃ­fica y reciente para ofrecer respuestas fundamentadas.

- **Mejore la precisiÃ³n:**  
  Al basar sus respuestas en datos oficiales, aumenta la fiabilidad y relevancia de la informaciÃ³n proporcionada.

---

### Documentos Normativos Utilizados

El sistema RAG se apoya en un conjunto de documentos clave que abarcan diversos aspectos de la ciberseguridad:

- **GDPR 2016/679:**  
  Reglamento General de ProtecciÃ³n de Datos de la UniÃ³n Europea, que establece las bases para la protecciÃ³n 
  de datos personales y la privacidad.

- **GDPR 2018/1725:**  
  Normativa orientada a la protecciÃ³n de datos en instituciones de la UniÃ³n Europea, aplicada en organismos 
  pÃºblicos y entidades gubernamentales.

- **ISO 27001:2022:**  
  Norma internacional para la gestiÃ³n de la seguridad de la informaciÃ³n, que proporciona un marco para establecer,
  implementar y mejorar un Sistema de GestiÃ³n de Seguridad de la InformaciÃ³n (SGSI).

- **NIST:**  
  Marco de seguridad cibernÃ©tica del Instituto Nacional de EstÃ¡ndares y TecnologÃ­a (EE.UU.), que ofrece directrices, 
  mejores prÃ¡cticas y estÃ¡ndares para la gestiÃ³n del riesgo y la protecciÃ³n de la informaciÃ³n.

---

### Arquitectura del Sistema

El sistema se compone de varias partes integradas que permiten su funcionamiento de manera conjunta:

- **RecuperaciÃ³n de Documentos:**  
  Los documentos normativos se indexan y almacenan en una base de datos (por ejemplo, ChromaDB) para facilitar su 
  bÃºsqueda y recuperaciÃ³n.

- **GeneraciÃ³n Aumentada (RAG):**  
  El modelo Deepseek utiliza la informaciÃ³n recuperada para generar respuestas detalladas y precisas, aprovechando
  tanto su conocimiento preentrenado como los datos externos.

- **Interfaz de API:**  
  Se emplea **FastAPI** para exponer el servicio, y mediante **ngrok** se genera una URL pÃºblica que permite 
  integrar y probar la soluciÃ³n en entornos remotos, como Google Colab.

---

### Beneficios de la SoluciÃ³n RAG en Ciberseguridad

La integraciÃ³n de la normativa en un sistema RAG ofrece mÃºltiples ventajas:

- **ActualizaciÃ³n Continua:**  
  El modelo puede acceder a informaciÃ³n normativa actualizada, lo que es esencial en un campo en constante evoluciÃ³n.

- **Respuestas Contextualizadas y Precisasy:**  
  Las respuestas se enriquecen con datos especÃ­ficos y relevantes, lo que mejora la calidad y exactitud de las 
  soluciones proporcionadas.

- **Facilidad de IntegraciÃ³n:**  
  La combinaciÃ³n de FastAPI y ngrok permite exponer el servicio a entornos remotos, facilitando la integraciÃ³n con 
  otras aplicaciones y sistemas.

- **Adaptabilidad y Escalabilidad:**  
  La tÃ©cnica RAG es flexible y puede ampliarse para cubrir otros Ã¡mbitos o conjuntos de datos, aumentando asÃ­ su 
  utilidad en diversas Ã¡reas del conocimiento.

---

### ConclusiÃ³n

Este notebook demuestra cÃ³mo la tÃ©cnica **RAG (Retrieval-Augmented Generation)** puede revolucionar la forma de 
abordar la ciberseguridad mediante:

- **RecuperaciÃ³n de InformaciÃ³n Actualizada:**  
  El modelo accede a documentos normativos y datos recientes para fundamentar sus respuestas.

- **GeneraciÃ³n de Respuestas Contextualizadas:**  
  Al combinar su conocimiento interno con informaciÃ³n externa, el modelo ofrece respuestas mÃ¡s precisas y adaptadas
  a las necesidades reales del entorno de la seguridad de la informaciÃ³n.

- **IntegraciÃ³n Sencilla y Eficiente:**  
  Gracias a FastAPI y ngrok, el sistema se integra fÃ¡cilmente en entornos remotos, permitiendo pruebas y adaptaciones 
  rÃ¡pidas.

Con esta configuraciÃ³n, el modelo **Deepseek R1 8B Ciberseguridad** puede proporcionar respuestas informadas, 
relevantes y contextualizadas a preguntas relacionadas con la seguridad de la informaciÃ³n, marcando un avance 
significativo en la aplicaciÃ³n de tÃ©cnicas RAG en el Ã¡mbito de la ciberseguridad.

---

## MÃ³dulo de Consulta a VirusTotal

Este mÃ³dulo permite verificar la seguridad de direcciones **IP** y **URLs** utilizando la API de **VirusTotal**. Se integra con un modelo de lenguaje para detectar direcciones sospechosas en un texto y generar respuestas automÃ¡ticas.

### Requisitos
Para utilizar este mÃ³dulo, es necesario contar con una clave de API de VirusTotal y acceso a una conexiÃ³n a internet.

### Funcionalidades
#### 1. Consulta de IPs
El mÃ³dulo permite verificar si una direcciÃ³n IP ha sido reportada como maliciosa en VirusTotal. Devuelve un informe con la cantidad de detecciones y una evaluaciÃ³n de seguridad basada en los anÃ¡lisis disponibles.

#### 2. Consulta de URLs
Se puede analizar una URL para determinar si ha sido identificada como maliciosa. El mÃ³dulo envÃ­a la URL a VirusTotal, obtiene los resultados del anÃ¡lisis y proporciona un veredicto de seguridad.

#### 3. DetecciÃ³n AutomÃ¡tica en Texto
Si un usuario proporciona un mensaje que contiene una IP o URL, el mÃ³dulo detecta automÃ¡ticamente la informaciÃ³n y consulta VirusTotal sin necesidad de una solicitud manual.

#### 4. GeneraciÃ³n de Respuestas Inteligentes
El mÃ³dulo no solo analiza direcciones, sino que tambiÃ©n genera respuestas automatizadas. Si no se detecta una IP o URL, responde de manera normal utilizando un modelo de lenguaje.

---

## Tesseract OCR: Reconocimiento Ã“ptico de Caracteres Optimizado

### IntroducciÃ³n

Este mÃ³dulo presenta una implementaciÃ³n avanzada de reconocimiento Ã³ptico de caracteres (OCR), utilizando Tesseract como motor principal. Para determinar la opciÃ³n mÃ¡s precisa y eficiente, se llevaron a cabo evaluaciones comparativas con otros frameworks de OCR, seleccionando Tesseract como la soluciÃ³n mÃ¡s equilibrada en tÃ©rminos de desempeÃ±o y exactitud.

### EvaluaciÃ³n de Modelos OCR

Se probaron tres soluciones de OCR para evaluar su precisiÃ³n y velocidad en el procesamiento de texto extraÃ­do de imÃ¡genes:

- **PaddleOCR**
- **EasyOCR**
- **Tesseract**

DespuÃ©s de realizar pruebas exhaustivas, **Tesseract** fue elegido como el motor OCR mÃ¡s adecuado debido a su excelente rendimiento tanto en tÃ©rminos de precisiÃ³n como de rapidez en el procesamiento de imÃ¡genes.

### ImplementaciÃ³n de uso

Para procesar una imagen y extraer su texto, se emplea la funciÃ³n `extraer_texto_img`, que incluye tÃ©cnicas de preprocesamiento previas al uso de **Tesseract OCR**. La implementaciÃ³n utilizada en el notebook es la siguiente:

```python

from PIL import Image, ImageEnhance
import pytesseract

def limpiar_texto(texto):
    """ Elimina espacios y carÃ¡cteres no deseados. """
    texto = texto.strip()
    texto = re.sub(r'\s+', ' ', texto)
    return texto.replace("\n", " ").replace("\r", "")

def preprocesar_imagen(imagen):

    """Convierte la imagen a escala de grises y mejora el contraste."""
    try:
       image = Image.open(imagen).convert("L")
        enhancer = ImageEnhance.Contrast(image)

        return enhancer.enhance(2.0)

    except Exception as e:

        return None

def extraer_texto_img(imagen):
    """Extrae y limpia el texto de una imagen."""
    image = preprocesar_imagen(imagen)
    if image is None:
        return "Error al procesar la imagen"
    texto_extraido = pytesseract.image_to_string(image)

    return limpiar_texto(texto_extraido)

```

### Detalles TÃ©cnicos

Para optimizar la precisiÃ³n del OCR, se implementaron las siguientes tÃ©cnicas de preprocesamiento:

- **ConversiÃ³n a escala de grises**: Minimiza el ruido cromÃ¡tico, facilitando la detecciÃ³n precisa de caracteres.
- **Ajuste de contraste**: Mejora la legibilidad del texto, especialmente en imÃ¡genes con iluminaciÃ³n deficiente o contrastes bajos.

stas optimizaciones aseguran que las imÃ¡genes estÃ©n listas para una detecciÃ³n Ã³ptima de texto por parte de Tesseract.

### Resultados

El resultado esperado al procesar una imagen es la salida del texto extraÃ­do con la mayor precisiÃ³n posible:

```
Texto extraÃ­do de la imagen con OCR optimizado.
```

Este texto extraÃ­do se integra en el pipeline de consulta de VirusTotal, de forma que, si se detecta una URL o direcciÃ³n IP, se realiza una consulta adicional a la API para verificar posibles amenazas.
